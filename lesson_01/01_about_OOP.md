# オブジェクト指向のおさらいとアンチパターン
オブジェクト指向が初めての人も、慣れ親しんだ人もいるかと思います。
そこで、特に初心者の方に向けておさらいをすると共に、
慣れている人は納得のアンチパターン(良くない例) を見ていこうと思います

## オブジェクト指向とは
プログラミングのソースコードをオブジェクト(物体)とみなし、オブジェクト間のメッセージング(処理の呼び出し等)により記述する開発手法。
一般的には Class や、instance、継承、カプセル化、ポリモーフィズム、Interface 等により構成されている物がお馴染み

### オブジェクト指向図解
![800px-proxy_pattern_diagram svg](https://user-images.githubusercontent.com/1944039/29357586-0846f9f2-82b3-11e7-8b0b-e70051cfcf5b.png)

### Class とは
プログラミングのソースコードをオブジェクトに見立てた物
Class 一つ一つに名称を付ける
実際の処理と、他の Class に対するメッセージングを記述する

- メリット
  - 大人数で開発を行う時に、処理名や、処理内容を共有しやすい
- デメリット
  - 処理を書くだけではなく、オブジェクトの定義をしなくてはならずコツがいる

### instance とは
Class というのはオブジェクトを定義した物。
例えると、プラモデルとその設計書(説明書)になります。
対して instance はその プラモデル、設計書を元に組み立てた物になります。

### 継承とは
プログラミングでは同じ用の処理を複数回必要な事があります。
そういった基本的な共通プログラミングを扱いやすくするのが継承です。
共通のプログラミングを Class として記述し、その共通プログラミングを再利用する Class は、継承という形で共通プログラミングの　Class を再利用する事が出来ます。
また、継承を親子関係に例えて、親Class、子Class という表現を行う事があります。

-メリット
  - 共通処理のプログラミングを再利用出来る
- デメリット
  - てきとーにプログラミングして継承ばかりしていると副作用が発生する

### カプセル化 とは
プログラミングの中で一部しか利用せず、再利用してはいけない処理を書く事があります。
その時に再利用しない処理を 他のオブジェクトから触れる事が出来ないよう、private な存在として Class の中に隠蔽する(閉じ込める)事をカプセル化という。

### ポリモーフィズム(多態性) とは
Class や、プログラミングで利用する値には、『型』と言うものを指定する。
その『型』を柔軟に扱う事ができる。
具体的には、型 『Animal』 を継承した『Dog』、『Cat』という型は、プログラミング上では、『Animal』として扱う事ができるようになり、処理の共通化再利用がしやすくなる。
ポリモーフィズムを利用しない場合は、『Dog』、『Cat』は全く別の型なのでそれぞれに応じた処理を書く必要があり、ソースコードが膨れ上がる

- メリット
  - プログラミング処理を共通化する事が出来る
- デメリット
  - 適切にポリモーフィズムを適用しないとメンテナンス性が下がり、バグが生まれやすくなる

### Interface とは
Class はプラモデルと設計書でしたが、Interface は設計書のみとも言えます。
特にポリモーフィズムを活用する為に利用され、Interface を定義して、その Interface を implements(実現という、継承とは呼び方が異なる) することで型の共通化を行う事ができます

- メリット
  - Class の継承よりも副作用が少ない
- デメリット
  - Class の継承に比べれば小さい物の、てきとーに使うと副作用が生じる

## オブジェクト指向の実装例
[オブジェクト指向実装例: Java](IntoroductoinToDesignPatterns/lessons/lesson_03/java/src/introductiontodesignpatterns/proengineer/ProEngineer.java)

## オブジェクト指向の副作用
オブジェクト指向は優れたプログラミング手法ですが、副作用もあります。
例えば下記が副作用の例です。

- オブジェクト指向を正しく使わないとメンテナンス性が下がり、スパゲッティコードが生まれやすい
  - Class の継承や、Interface の実現が子、孫、ひ孫、玄孫……と続いていくと、親を変更した際に、その子孫全てに影響が出てしまいます
  - これは、タイムスリップ物語によくある『過去を改変すると、その後の次代に影響が出る』という事に似ています
- ソースコードの記述が必要以上に膨れ上がりやすい
  - プラモデルの例え話を思い出してみましょう。最終的に必要な物は完成したプラモデルですが、そのプラモデルの為に完成前のプラモデルと設計書が沢山必要になります
  - また、ソースコードの記述が多くなるということは、プラモデルの部品が増えるということ。似た部品が増えて来ると組み立てミスも多くなりがち。そしてそれはバグの温床になります
- 複雑な部品の扱い
  - プログラミングでは時に複雑な部品を作る事もあります。その時に設計書を適切に作り込まないと、他の技術者が組み立てを行う時に間違った組み立てをするという事が起こりやすくなります

## オブジェクト指向のアンチパターン例
- サブクラス(子、孫、ひ孫、、、と先祖から子孫が果てしない……)地獄に陥る
- 特化した機能のクラスが意図していない所で再利用され、メンテンナンスしずらい修正が行われる
  - 設計上意図しない修正は後で技術的負債に繋がる可能性がある
- 理想を求めすぎた実装により、ファイル数が増えすぎ、メンテンナスが面倒になる
- 一つのクラスの役割が肥大化し過ぎて何をしているの良くわからなくなる
- 美しい設計をしても、オブジェクト指向を知らない技術者が滅茶苦茶にしていく

## オブジェクト指向を適切に使う
副作用を見るとオブジェクト指向は難しく思えてきます。
実は先人達もオブジェクト指向のメリット/デメリットの間で何が正しいのかを模索し続けてきました。
そして、素晴らしいアイディアが実践の中で生まれてきました。

### 古典的なアンチパターンへの対処
- DRY 原則: Don’t Repeat Yourself (繰り返しするな！)  の頭文字を取った物
  - 同じプログラミング処理を作らず、共通部品を作ろうという考え方
    - プラモデルでいうと、汎用的な共通の部品があれば、色々な所で間違わずに組み立てやすくなります
- KISS 原則: Keep it simple stupid (馬鹿みたいにシンプルにしろ！)の頭文字を取った物
  - 出来る限りシンプルなプラモデルの部品、設計書を作ろうという意味になります
    - 細かい複雑な部品は組立時に技術者に技術力を要求します。シンプルならば組み立てやすい！
  - プログラミングの記述は幾らでも難しく高度に書く事、例えば処理を高速化したり可能ですが、経験則的にそれは必要に迫られてから最適化した方が上手く行く事が多いです

他にも様々な原則が生み出されています。
下記サイトに基本的な原則が書かれています。
興味があれば是非見てましょう
https://qiita.com/hirokidaichi/items/d6c473d8011bd9330e63

### オブジェクト指向の応用的アンチパターン対策
様々な原則を取り入れても、やはりオブジェクト指向が難しい事に変わりはありません。
そこで、オブジェクト指向により開発の成功/失敗体験から素晴らしいアイディアが生まれました。
1995年 Gang Of Four(GOF; 4人組) により発表された『デザインパターン(設計パターン)』です。
デザインパターンはオブジェクト指向のベストプラクティス集。
言わば最適なプラモデル部品、設計書作りのマニュアル本と言えるでしょう。
新しいプログラミング言語やフレームワークではデザインパターンを言語仕様に取り込んだ物もあります。

- メリット
  - オブジェクト指向のアンチパターンを解決してくれる
- デメリット
  - それぞれが難しく、学習するのに時間が掛かる

### デザインパターンを解りやすく覚える
デザインパターンの登場はオブジェクト指向プログラミングの完成度をより高める素晴らしい物でした。
しかし、理解をするのが難しい……。

そこで登場したのが UML(Unified Modeling Language; 統一モデリング言語) です。
言語と言われていますが、簡単に説明すると『図の書き方』になります。
「デザインパターンをどうすれば解りやすく表現出来るか？」というテーマで 1997年にUML 1.1 がリリース。
2005 年に UML 2.0 がリリースされました。
 興味のある方は以前に デザインパターンの勉強会をした時の資料があるのでそちらをご覧下さい

### オブジェクト指向アンチパターン その他解決策
その他にもアンチパターンを解決する方法があります。
それは、オブジェクト指向以外の開発手法を取り込む方法です。

オブジェクト指向同様に、他の切り口から研究、発展した開発手法があります。
代表的な物に下記の開発手法があります。

- 構造化プログラミング
- アスペクト指向プログラミング
- 関数型プログラミング
- 並列プログラミング

それぞれがオブジェクト指向同様に難しい物ですが、非常に強力な物です。興味があれば調べるとスキルアップへの貢献間違いなしです。

## オブジェクト指向おさらいとアンチパターンまとめ
オブジェクト指向は一つのアイディアとして優れた物ではありますが、アンチパターンが存在する
アンチパターン解決の方法も沢山ある
Golang はオブジェクト指向アンチパターンに対する一つの解決策(かも！)！

